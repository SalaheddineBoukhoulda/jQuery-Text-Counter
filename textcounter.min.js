/*!
* jQuery Text Counter Plugin v0.6.4
* https://github.com/ractoon/jQuery-Text-Counter
*
* Copyright 2014 ractoon
* Released under the MIT license
*/
!function(t){t.textcounter=function(e,n){var o=this;o.$el=t(e),o.el=e,o.$el.data("textcounter",o),o.init=function(){o.options=t.extend({},t.textcounter.defaultOptions,n);var e=o.options.countDown?o.options.countDownText:o.options.counterText,r=o.options.countDown?o.options.max:0,i=t("<div/>").addClass("text-counter-div").html(e.replace("%d",'<span class="'+o.options.textCountClass+'">'+r+"</span>")),s=t("<div/>").addClass(o.options.countOverflowTextCss);o.hideMessage(s),o.$container=t("<"+o.options.countContainerElement+"/>").addClass(o.options.countContainerClass).append(i).append(s),o.$text_counter=o.$container.find("span"),o.$el.after(o.$container),o.$el.bind("keyup.textcounter click.textcounter blur.textcounter focus.textcounter change.textcounter paste.textcounter",o.checkLimits).trigger("click.textcounter"),o.options.init(o.el)},o.checkLimits=function(e){var n=o.$el,r=(o.$container,n.val()),i=0,s=0,a=void 0!==e.originalEvent;if(t.isEmptyObject(r)||(i=o.textCount(r)),"auto"==o.options.max){var u=o.$el.attr("maxlength");void 0!==u&&!1!==u?o.options.max=u:o.$container.text("error: [maxlength] attribute not set")}if(s=o.options.countDown?o.options.max-i:i,o.setCount(s),o.options.min>0&&a&&(i<o.options.min?(o.setErrors("min"),o.options.minunder(o.el)):i>=o.options.min&&(o.options.mincount(o.el),o.clearErrors("min"))),-1!==o.options.max)if(i===o.options.max&&0!==o.options.max)o.options.maxcount(o.el),o.clearErrors("max");else if(i>o.options.max&&0!==o.options.max)if(o.options.stopInputAtMaximum){var c="";if("word"==o.options.type)for(var l=r.split(/[^\S\n]/g),p=0;p<l.length&&!(p>=o.options.max);)void 0!==l[p]&&(c+=l[p]+" ",p++);else{var x=o.options.twoCharCarriageReturn?o.options.max-o.twoCharCarriageReturnCount(r):o.options.max;if(o.options.countSpaces)c=r.substring(0,x);else for(var m=r.split(""),d=m.length,f=0,p=0;f<x&&p<d;)" "!==m[p]&&f++,c+=m[p++]}n.val(c.trim()),i=o.textCount(n.val()),s=o.options.countDown?o.options.max-i:i,o.setCount(s)}else o.setErrors("max");else o.options.maxunder(o.el),o.clearErrors("max")},o.textCount=function(t){return"word"==o.options.type?o.wordCount(t):o.characterCount(t)},o.wordCount=function(t){return t.trim().replace(/\s+/gi," ").split(" ").length},o.characterCount=function(t){var e=0,n=0;if(o.options.twoCharCarriageReturn&&(n=o.twoCharCarriageReturnCount(t)),e=o.options.countSpaces?t.replace(/[^\S\n|\r|\r\n]/g," ").length:t.replace(/\s/g,"").length,o.options.countExtendedCharacters){var r=t.match(/[^\x00-\xff]/gi);e=null==r?t.length:t.length+r.length}return o.options.twoCharCarriageReturn&&(e+=n),e},o.twoCharCarriageReturnCount=function(t){var e=t.match(/(\r\n|\n|\r)/g),n=0;return null!==e&&(n=e.length),n},o.setCount=function(t){o.$text_counter.text(t)},o.setErrors=function(t){var e=o.$el,n=o.$container,r="";switch(e.addClass(o.options.inputErrorClass),n.addClass(o.options.counterErrorClass),t){case"min":r=o.options.minimumErrorText;break;case"max":r=o.options.maximumErrorText,o.options.countOverflow&&o.setOverflowMessage()}o.options.displayErrorText&&(n.children(".error-text-"+t).length||n.append("<"+o.options.errorTextElement+' class="error-text error-text-'+t+'">'+r+"</"+o.options.errorTextElement+">"))},o.setOverflowMessage=function(){o.hideMessage(o.$container.find(".text-counter-div")),o.removeOverflowMessage();var t=o.options.countOverflowText.replace("%d",o.textCount(o.$el.val())-o.options.max).replace("%type",o.options.type),e=o.$container.find("."+o.options.countOverflowTextCss).append(t);o.showMessage(e)},o.removeOverflowMessage=function(){o.$container.find("."+o.options.countOverflowTextCss).empty()},o.showMessage=function(t){t.css("display","inline")},o.hideMessage=function(t){t.css("display","none")},o.clearErrors=function(t){var e=o.$el,n=o.$container;n.children(".error-text-"+t).remove(),0==n.children(".error-text").length&&(o.removeOverflowMessage(),o.showMessage(o.$container.find(".text-counter-div")),e.removeClass(o.options.inputErrorClass),n.removeClass(o.options.counterErrorClass))},o.init()},t.textcounter.defaultOptions={type:"character",min:0,max:200,countContainerElement:"div",countContainerClass:"text-count-wrapper",textCountClass:"text-count",inputErrorClass:"error",counterErrorClass:"error",counterText:"Total Count: %d",errorTextElement:"div",minimumErrorText:"Minimum not met",maximumErrorText:"Maximum exceeded",displayErrorText:!0,stopInputAtMaximum:!0,countSpaces:!1,countDown:!1,countDownText:"Remaining: %d",countExtendedCharacters:!1,twoCharCarriageReturn:!1,countOverflow:!1,countOverflowText:"About %d %type has been entered",countOverflowTextCss:"text-overflow-div",maxunder:function(t){},minunder:function(t){},maxcount:function(t){},mincount:function(t){},init:function(t){}},t.fn.textcounter=function(e){return this.each(function(){new t.textcounter(this,e)})}}(jQuery);